---
next:
  text: 'К содержанию'
  link: '/ml/ml_index'
prev: false
---

# Многоклассовая классификация (Multiclass classification)

Существует несколько основных подходов к решению этой задачи:

## 1. Сведение к серии бинарных задач

### 1.1. Один против всех (one-vs-all, one vs rest)

![alt](https://i.imgur.com/K3kNwqs.png)

**Идея**: Строим для каждого класса свой классификатор, который будет отделять свой класс от других. Когда приходит новый объект, мы выбираем класс с максимальной уверенностью.

- $b_{k}(x)$ - классификатор для $k$-того класса. Обучаем его на $X_{k}=(x_{i}, [y_{i}=y_{k}])$.
- $a(x) = \mathop{\text{argmax}}_{ k=1\dots \ell } b_{k}(x)$

Плюсы:

- Легко построить

Минусы:

- Много классов $\implies$ много параметров (ну типо)
- $b_{k}$ не знают друг о друге при обучении (есть риск того, что при переобучении одна модель будет всегда лучше другой, что портит качество классфикатора).

### 1.2 Все пров всех (all-vs-all)

**Идея**: Делаем $C^{2}_{k}$ классификаторов, которые умеют отличать $i$-ый клас от $j$-того класса.

$a_{ij}$ обучаем на $X_{ij}=\{(x_{n}, y_{n} \mid y_{n \in \{i, j\}})\}$.
$$a(x) = \mathop{\text{argmax}}_{ n = 1\dots k } \sum_{j\neq k} [a_{kj}(x)=n]$$

Плюсы:

- Нет проблем с неоткалиброванными увереностями
Минусы:

- $K^2$ классификаторов

## 2. Прямые подходы

**Идея**: Меняем бинарные модели так, чтобы они работали для многоклассовой классификации.

**Пример**: многоклассовая логистическая регрессия

$$ b_{k} = \langle w, x \rangle + w_{0}$$
$$x\to b(x) = (b_{1}(x)\dots b_{k}(x))$$
$$\text{Softmax}(z_{1}\dots z_{n}) = \left( \frac{e^{z_{1}}}{\sum_{i=1}^{k} e^{z_{i}}} \dots  \frac{e^{z_{k}}}{\sum_{i=1}^{k} e^{z_{i}}} \right)$$

Чтобы корректно оценивать веростности с помощью softmax:, нужно ввести дополнительные пребования
$$P(x | y_{k} = +1) = \frac{\exp(\langle w, x \rangle + w_{0})}{\sum_{j=1}^{k} \exp(\langle w_{j} x\rangle +w_{0j})}$$

В результате будем оптимизировать
$$ \sum_{i=1}^{\ell} \log P(y=y_{i} \mid x) \to \mathop{\text{max}}_{ w, w_{0} } $$

## Метрики качества многоклассовой классификации

1. $accuracy = \frac{1}{\ell} \sum_{i=1}^{\ell} [a(x_{i})=y] \implies$ Легко переносится на задачи многоклассвой классификации.
2. Прочее:
Рассмотрим отдельные метриуи для k-ого класс: $TP_{k}, TN_{k}, FP_{k}, FN_{k}$.
Всего существует 2 основных подхода к классификации: макро- и микроусреднее
![alt](https://i.imgur.com/IgPnCWU.png)
