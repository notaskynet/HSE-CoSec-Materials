---
next:
  text: 'К содержанию'
  link: '/ml/ml_index'
prev: false
---

# Измерение ошибки в задачах регресии

$$Q(a, L, X) = \frac{1}{\ell} \sum_{i=1}^\ell L(y_i, a(x_i))$$
где:
- $Q$ - функционал ошибки
- $L$ - функция ошибки

## Функции ошибки

- **MSE** $$ L(y, z) = (y - z)^2 $$
- **RMSE**. MSE плохо интерпритиркем, поэтому в можно взять в качестве функционала корень из среднеквадратичного отклонения. Оптимальная константа: $\bar{y}$.
$$ \text{RMSE}(a, X) = \sqrt{\frac{1}{\ell} \sum_{i=1}^\ell (y_i - a(x_i))^2 } $$
- **Коэффициент детерминации $R^2$**. Не всегла понятно, насколько та или иная ошибка показывает, зхорошо работает модель или нет, поэтому иногда использует коэффициент детерминации
$$ R^2 = 1 - \frac{\sum_{i=1}^\ell (a(x_{i})-y_{i})^2}{\sum_{i=1}^\ell(\bar{y}-y_{i})^2} $$
$$ a(x_{i})=y_{i}\implies R^2 = 1 $$
$$ a(x_{i})=\bar{y}\implies R^2 = 0 $$
$$\text{Для разумных моделей: } 0 \leq R^2 \leq 1$$
- **MAE**. $L(y, z) = |y - z|$
$$ MAE = \frac{1}{l} \sum_{i=1}^l |a(x_{i})-y_{i}|$$
*Примечание*. MAE более устояива к выбросам

![alt](https://i.imgur.com/Rt9pg1p.png)

- **Huber Loss**
$$ L_{\delta}(y, z) =
\begin{equation}
\left\{  
\begin{array}{}
\frac{1}{2} (y-z)^2, |y-z| < \delta \\  
\delta (|y-z| - \frac{1}{2} \delta), |y-z| \geq \delta \\  
\end{array}  
\right. 
\end{equation}
$$
![alt](https://i.imgur.com/cSvYXOy.png)

Проблема: Нет второй производной в точке перехода.

- Log-cosh. $$ L(y, z) = \log \cosh (y-z) $$
- MSLE. Используется в случае, если ошибка различается на несколько порядков.
$$ L(y, z) = (\log (z+1) - \log (y + 1))^2$$

## Относительные функции потерь

- **MAPE**
$$ L(y, z) = | \frac{y-z}{y} | $$
$$ MAPE(X, a) = \frac{1}{\ell} \sum | \frac{y_{i}-a(x_{i})}{y_{i}} | $$

| Плюсы                       | Минусы                      |
| --------------------------- | --------------------------- |
| Хорошая интерпретируемость  | Не симметрична              |
| Хороша при разных масштабах |                             |

- **SMAPE**. Симметричная MAPE:
$$ L(y, z) = \frac{|y-z|}{\frac{|y| + |a|}{2}}$$
